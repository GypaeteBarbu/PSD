---
title: "Documentation fickus"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```




## fickus

This function allows us to construct a Hermitian matrix **$K^\Pi$** with diagonal $\Pi$ of size N  and fixed spectrum $\lambda^{N}\in$ [0,1], the diagonal $\Pi$ representing the first inclusion probabilities.


It has been proved that the set of Hermitian matrices $K^\Pi$ of diagonal $\Pi$   can be represented by the triplet **(M,$\Omega,\rho$)**.  **M** is an integer giving the number of strictly positive eigenvalues of $K^\Pi$ . **$\Omega$** is a matrix of [0,1]$^{(M*N)}$ whose kth column allows to construct the spectrum of the k-order principal sub-matrix of $K^\Pi$ and **$\rho$** is a matrix of [0,1] $^{(M*N-1)}$ allowing to modify the value of the off-diagonal coefficients of $K^\Pi$ without altering the spectra of the principal sub-matrices of $K^\Pi$.  

***fickus*** takes as inputs:

* any vector of the first inclusion probabilities **$\Pi$**
* **$\Omega$**(the default value is a matrix with coefficient 0.5)
* **$\rho$** (the default value is a matrix with coefficient 0.5),  for example if I want to create a matrix with coefficients $\Pi/4$ the user will just have to enter 1/4 as coefficients. 
* **M** (the default value is n=$\sum_{k=1}^{N}\Pi_k$)
* **spectre** correspond to spectrum of $K^\Pi$ if the user is using a particular spectrum otherwise it will be generated by the function.  
* **U** a unit matrix.
* boolean **option** for the type of return(the default value is TRUE)  


***fickus*** offers two types of output,that both provide whole necessary information.the user indicates his choice between the two with the boolean **option** in input.

* first type of output is  a list containing the spectrum matrix and the matrix $K^\Pi$ correspond to option=TRUE.
* second type of output is a list containing the spectrum matrix and  $\phi$ such that $(\bar\phi)^{t}\phi=K^\Pi$ correspond to option=FALSE . 

in the particular case M=n, we obtain a projection matrix.


```{r packages, echo=FALSE,results='hide'}
source("fickus.R")
source("Rfickus.R")
```

```{r fickus}

omega=matrix(1,5,10)
omega[,10]=matrix(0.5,5,1)
m_pi=c()
for (k in 1:10){
  m_pi[k]=6*(11-k)/110
}

fic=fickus(omega,M=5,pi=m_pi,option=TRUE)
print(fic)
print(fic$K)
print(fic$spectre)


```














## Rfickus


this function allows to find the parameters $\Omega$ and $\rho$ which allowed to build the hermitian matrix $K^\Pi$ obtained through the program fickus,it is the reciprocal of fickus.


***Rfickus*** takes as input takes as input a single parameter the matrix $K^\Pi$ and returns as output a list containing $\Omega$, $\rho$ and the spectrum matrix.

```{r Rfickus}

 
 omega=matrix(0.5,3,10)
 rho=matrix(0.25,3,9)
 
 m_pi=c()
 for (k in 1:10){
   m_pi[k]=6*(11-k)/110
 }
 
 fic=fickus(omega,rho,M=3,pi=m_pi)

rfic=Rfickus(fic$K)
print(rfic)
print(rfic$omega)
print(rfic$rho)

```