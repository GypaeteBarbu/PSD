<a href="https://www.insee.fr/fr/accueil"> <img src="docs/img/Logo_Insee.svg.png?raw=true" width="150" align="right"> </a>
# PSD

"plan de sandage déterminantaux"

This project is to provide tools in several programming languages to find kernels that best minimize the objective function.  

- $N$  population size
- $n$ number of individual select
- $Q$ number of auxiliary variables 
- $\Pi$ a probability vector
- $X$ a  auxilary matrix 
- $r$ a real number
- $K$ a hermitian projection matrix 

subject to :

- $N$ is a interger such that $N > 1$
- $n$ is a interger such that $1 < n < N$
- $Q$ is a interger such that $Q > 1$
- $\Pi$ a vector such that $\Pi = (\Pi_1,\cdots,\Pi_N)$ and $0 < \Pi_i < 1 , i=1\cdots=N$ and $\mathrm{sum}(\Pi)= n$
- $X$ is a matrix such that $\mathrm{size}(X) = (N,Q)$
- $r$ is a number such that $r \in \mathbb{R}$
- $K$ is a matrix such that $\mathrm{size}(K) = (N,N)$, $\mathrm{diag}(K) = \Pi$, $K = v \cdot v^\top$ with $v$ a matrix $v^\top \cdot v = \mathbb{I}_n$ $\mathrm{size}(v) = (N,n)$

For more information there is a documentation.

- [![Generic badge](https://img.shields.io/badge/with--made-python-informational.svg)](https://shields.io/)
- [![Generic badge](https://img.shields.io/badge/with--made-matlab-informational.svg)](https://shields.io)
<!-- - [![shield](http://img.shields.io/badges/made with-r-informational)](http://forthebadge.com) -->
<!-- - [![shield](http://img.shields.io/badges/made with-matlab-informational)](http://forthebadge.com) -->


## descriptive on the directorys

### sample

sample is directory, where there are csv files to use for the programs.

files with formats X_N_n.csv are data.

columns :
- "j" indices
- "x1,x2,x3" a auxillary matrix $X1,X2,X3$
- "pi" probability vector $\Pi$

files with formats Ppi_Xq_N_n.csv are matrix minimize the objective function

columns:
- "C..." are columns of matrix

files with formats K_N_n.csv generated by algo fickus argument "pi" of X_N_n.csv

columns:
- "v..." are columns of matrix

files with formats Kr_Xq_N_n.csv get by the algo rotation with arguements  "K" of K_N_n.csv ,"xq" of X_N_n.csv, $\rho =  \text{\{0\}}^{(N-1) \times n}$

columns:
- "v..." are columns of matrix

### python_ 
python_ is directory, where thre are python programs.
- funpymanopt.py the functions that use the pymanopt packages
- progpymanopt.py the main prog
- requirements.txt and requirements.in install package
- rutime.txt chanege the version python

### matlab_
matlab_ is directory, where thre are matalab programs.

#### program
- progmanopt.m progam with tools manopt
- progpenlab.m progam with penlab manopt
- progrotation.m progam with algo rotation

#### function
##### function in various programs
- f.m objective function
- fungrad.m gradient objective function
- funhess.m hessian objective function
##### progmanopt
- penobj.m penality function
- pengrad.m gradient penality function
- penhess.m hessian penality function
- Cost.m cost function
- Egrad.m eulidian gradient cost function
- Ehess.m eulidian hessian cost function
- create_manopt.m create the problem
- solve_manopt.m solver the problem
- best_pen.m find the best penality factor
##### progpenlab
- objfun.m objective function
- objgrad.m gradient objective function
- objhess.m hessian objective function
- confun.m constraint function
- congrad.m gradient constraint function
- conhess.m hessian constraint function
- create_penlab create problem
##### progrotation
- algo_rotation.m solver the problem with algo rotation
- completed_W.m completed $W_{k,l}(\theta)$ matrix
- reset_W.m reset $W_{k,l}(\theta)$ matrix
- rotation.m  algo roatation
<!-- --> 
## to get started

### PYTHON
To use the program with the manopt method, it is neccessary in `progpymanopt.py` to change the variable Pi and X and r in the 
```python 
if __name__ == '__main__'
```
Pi must be of type numpy dim-1 and X must be of type numpy dim-2 and r must be of type int or float.  

### MATLAB

#### manopt
To use the program with the manopt method, it is neccessary in `progmanopt.m`  to change the variable Pi and X and r. Pi must be of real column vector and X must be of real matrice and r must be of type int or float.
#### penlab
disclamers the programs penlab runs but they do not give satisfactory results.

To use the program with the penlab method, it is neccessary in `progpenlab.m` to change the variable $K$ and X. K,Pi. K must be of real matrix and and Pi real column vector and X must be of real matrice.
#### rotation    
To use the program with the rotation method, it is neccessary in `progrotation.m`  to change the variable K and X. K must be of real or hermitian matrix and X must be of real matrice.         
<!--
 $\Omega \sim \mathcal{U}([0,1]^{N \times n})$
### R
### Julia
-->

## pre-requisites

### PYTHON

- [![Generic badge](https://img.shields.io/badge/python-3.7.3-brightgreen.svg)](https://shields.io)

the use of program progmanopt requires :  

- [![Generic badge](https://img.shields.io/badge/pandas-0.24.2-brithtgreen.svg)](https://shields.io)
- [![Generic badge](https://img.shields.io/badge/autograd-1.4-brithtgreen.svg)](https://shields.io)
- [![Generic badge](https://img.shields.io/badge/manopt-2.0-brithtgreen.svg)](https://shields.io)
- [![Generic badge](https://img.shields.io/badge/pytorch-1.12-brithtgreen.svg)](https://shields.io)
<!-- - [![Generic badge](https://img.shields.io/badge/tensorflow-?-brithtgreen.svg)](https://shields.io) -->

if the packages are not installed. you can install them with `requirements.txt` command line:

```
pip install -r requirements.txt
```

### MATLAB


<!--**[matlab](https://fr.mathworks.com/products/matlab.html)** version R2018b +-->
- [![Generic badge](https://img.shields.io/badge/matlab-R2018b-brithtgreen.svg)](https://shields.io)

the use of program progpenlab requires the installation of the package [![Generic badge](https://img.shields.io/badge/pelab-1.04-brithtgreen.svg)](https://shields.io).  
the use of program progmanopt requires the installation of the package [![Generic badge](https://img.shields.io/badge/manopt-7.0.0-brithtgreen.svg)](https://shields.io).   
the use of program progrotation in matlab requires no packages.
<!-- dépandance --> 

<!--
### JULIA


-->

## Contibutor

- **Vincent LOONIS**
- **Fabrice Nathan TCHAZOU KAMWA**
- **Loik johan ACAKPO-ADDRA** _alias_ [@loik77360](https://github.com/loik77360/PSD)

## Links

### packages

- **[penlab](https://web.mat.bham.ac.uk/kocvara/penlab)**
- **[manopt](https://www.manopt.org/)**
- **[pandas](https://pandas.pydata.org/)**
- **[autograd](https://pypi.org/project/autograd/)**
- **[pytorch](https://pytorch.org/)**
<!-- **[tensorflow](https://www.manopt.org/tutorial.html)** -->



### Documentation
- **[rotation](https://www.sciencedirect.com/journal/journal-of-statistical-planning-and-inference)**   
- **[PSD and fickus](docs/documentation/Techniques_d_enquete.pdf)**
<!-- liks -->





